{% extends "base.html" %}
{% block title %}Home - Team Asha Randonneuring{% endblock %}

{% block extra_head %}
<style>
/* Animated gradient background */
.hero-gradient-bg {
    position: absolute;
    top: -50%;
    left: -50%;
    right: -50%;
    bottom: -50%;
    background: linear-gradient(45deg,
        rgba(26, 54, 93, 0.8),
        rgba(42, 74, 127, 0.6),
        rgba(26, 54, 93, 0.8),
        rgba(42, 74, 127, 0.6)
    );
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    z-index: 1;
}

@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

/* Photo glow effect */
.hero-photo-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 380px;
    height: 270px;
    background: radial-gradient(circle, rgba(252, 129, 129, 0.3), transparent 70%);
    border-radius: 12px;
    animation: pulseGlow 3s ease-in-out infinite;
    z-index: 0;
}

@keyframes pulseGlow {
    0%, 100% { opacity: 0.4; transform: translate(-50%, -50%) scale(1); }
    50% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.05); }
}

/* Hero photo hover effect */
.hero-photo {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.hero-photo:hover {
    transform: scale(1.02);
    box-shadow: 0 8px 30px rgba(0,0,0,0.4);
}

/* Title entrance animation */
.hero-title {
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 0.2s;
}

.hero-description {
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 0.4s;
}

.hero-goal {
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 0.6s;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 0.9;
        transform: translateY(0);
    }
}

/* Parallax effect (applied via JavaScript) */
.hero-content {
    transition: transform 0.1s ease-out;
}

/* Responsive styles */
@media (max-width: 768px) {
    .hero-section img {
        width: 100% !important;
        height: auto !important;
        max-width: 360px;
    }
    .hero-content {
        flex-direction: column;
        text-align: center !important;
    }
    .hero-text {
        text-align: center !important;
    }
    .hero-section h1 {
        font-size: 1.6rem !important;
    }
    .hero-section p {
        font-size: 0.9rem !important;
    }
    .hero-photo-glow {
        width: 100%;
        max-width: 380px;
        height: auto;
        aspect-ratio: 360 / 250;
    }
}

@media (max-width: 480px) {
    .hero-section h1 {
        font-size: 1.4rem !important;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="hero-section relative overflow-hidden bg-gradient-to-br from-primary via-primary-dark to-primary text-white py-8 px-5 text-center">
    <!-- Animated gradient background -->
    <div class="hero-gradient-bg"></div>

    <div class="hero-content relative z-10 flex items-center justify-center gap-8 flex-wrap max-w-[1100px] mx-auto">
        <!-- Team photo with overlay effects -->
        <div class="hero-photo-wrapper relative">
            <div class="hero-photo-glow"></div>
            <img src="{{ url_for('static', filename='team_photo.jpg') }}" alt="Team Asha riders" class="hero-photo w-[360px] h-[250px] object-cover rounded-xl shadow-[0_4px_20px_rgba(0,0,0,0.3)] relative z-10">
        </div>

        <!-- Hero text with animations -->
        <div class="hero-text text-left max-w-[500px]">
            <h1 class="hero-title text-[2rem] mb-2 font-extrabold" style="text-shadow: 2px 2px 8px rgba(0,0,0,0.4);">
                Team <span class="text-accent-light">Asha</span> Randonneuring
            </h1>
            <p class="hero-description text-[0.95rem] opacity-90 mb-2.5" style="text-shadow: 1px 1px 4px rgba(0,0,0,0.3);">
                Bay Area cyclists pushing boundaries through ultra-distance randonneuring &mdash; raising funds for education of underprivileged children in India through Team Asha.
            </p>
            <p class="hero-goal text-[0.9rem] opacity-85" style="text-shadow: 1px 1px 4px rgba(0,0,0,0.3);">
                <strong>Building toward <a href="https://www.paris-brest-paris.org/en/" target="_blank" class="text-accent-light hover:underline transition-all">Paris-Brest-Paris 2027</a></strong></p>
        </div>
    </div>
</div>

<div class="stats-row grid grid-cols-2 md:grid-cols-5 gap-5 -mt-10 mx-auto px-5 max-w-[1200px] relative z-10">
<div class="bg-card-bg rounded-xl p-6 text-center shadow-[0_4px_15px_rgba(0,0,0,0.08)] border border-border">
    <div class="text-[2.2rem] font-extrabold text-primary stat-number" data-target="{{ stats.riders }}">0</div>
    <div class="text-[0.85rem] text-text-light uppercase tracking-wider mt-1">All-Time Riders</div>
</div>
<div class="bg-card-bg rounded-xl p-6 text-center shadow-[0_4px_15px_rgba(0,0,0,0.08)] border border-border">
    <div class="text-[2.2rem] font-extrabold text-primary stat-number" data-target="{{ stats.rides }}">0</div>
    <div class="text-[0.85rem] text-text-light uppercase tracking-wider mt-1">All-Time Brevet Rides</div>
</div>
<div class="bg-card-bg rounded-xl p-6 text-center shadow-[0_4px_15px_rgba(0,0,0,0.08)] border border-border">
    <div class="text-[2.2rem] font-extrabold text-primary stat-number" data-target="{{ stats.kms }}">0</div>
    <div class="text-[0.85rem] text-text-light uppercase tracking-wider mt-1">All-Time Brevet KMs</div>
</div>
<div class="bg-card-bg rounded-xl p-6 text-center shadow-[0_4px_15px_rgba(0,0,0,0.08)] border border-border">
    <div class="text-[2.2rem] font-extrabold text-primary stat-number" data-target="{{ stats.srs }}">0</div>
    <div class="text-[0.85rem] text-text-light uppercase tracking-wider mt-1">All-Time Super Randonneurs</div>
</div>
<div class="bg-card-bg rounded-xl p-6 text-center shadow-[0_4px_15px_rgba(0,0,0,0.08)] border border-border hover:-translate-y-0.5 hover:shadow-[0_6px_20px_rgba(0,0,0,0.12)] transition-all">
    <div class="text-[1.6rem] font-extrabold text-primary"><a href="https://www.paris-brest-paris.org/en/" target="_blank" class="text-inherit no-underline">PBP 2027</a></div>
    <div class="text-[0.85rem] text-text-light uppercase tracking-wider mt-1">Next Goal</div>
    <div class="text-[0.7rem] text-text-light mt-0.5">Aug 17&ndash;21, 2027</div>
</div>
</div>

<div class="max-w-[1200px] mx-auto px-5 py-10">
<div class="bg-card-bg rounded-xl p-6 shadow-[0_2px_8px_rgba(0,0,0,0.06)] border border-border mb-5 fade-in-up">
<h2 class="text-[1.6rem] mb-5 text-primary pb-2.5 border-b-[3px] border-accent inline-block">What is Randonneuring?</h2>
<p class="mt-4">Randonneuring is a long-distance cycling sport where riders complete timed courses called <strong>brevets</strong>. Starting at 200km and progressing through 300km, 400km, 600km, and beyond, riders must finish within strict time limits while navigating through checkpoints called controls. It's not a race &mdash; it's a test of endurance, self-reliance, and determination.</p>
<p class="mt-2.5"><a href="{{ url_for('main.about') }}" class="text-primary no-underline font-semibold hover:text-accent hover:underline">Learn more about randonneuring &rarr;</a></p>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-5 mt-5">
{% for ss in season_summaries %}
<div class="bg-card-bg rounded-xl p-6 shadow-[0_2px_8px_rgba(0,0,0,0.06)] border border-border stagger-item">
<h3 class="text-primary mb-2.5">{{ ss.name }} Season</h3>
{% if ss.is_current %}
<p>Our current season is underway &mdash; riders are building fitness and qualifying for <strong>Paris-Brest-Paris 2027</strong>.</p>
{% else %}
<p>{{ ss.active_riders }} riders completed {{ ss.total_rides }} brevets covering {{ ss.total_kms|commafy }} km.{% if ss.sr_rider_count > 0 %} {{ ss.sr_rider_count }} Super Randonneurs.{% endif %}</p>
{% endif %}
<p class="mt-2.5"><a href="{{ url_for('riders.season_riders', season_name=ss.name) }}" class="text-primary no-underline font-semibold hover:text-accent hover:underline">View {{ ss.name[:4] }}/{{ ss.name[5:] }} season &rarr;</a></p>
</div>
{% endfor %}
</div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Animated counter for statistics
function animateCounter(element, target, duration = 400) {
    const start = 0;
    const increment = target / (duration / 16); // 60fps
    let current = 0;

    const updateCounter = () => {
        current += increment;
        if (current < target) {
            // Format number with commas if it's large
            const displayValue = Math.floor(current);
            element.textContent = displayValue.toLocaleString();
            requestAnimationFrame(updateCounter);
        } else {
            // Ensure we end at exact target value
            element.textContent = target.toLocaleString();
        }
    };

    requestAnimationFrame(updateCounter);
}

// Intersection Observer to trigger animation when stats come into view
const observerOptions = {
    threshold: 0.3,
    rootMargin: '0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting && !entry.target.classList.contains('animated')) {
            entry.target.classList.add('animated');
            const statCards = entry.target.querySelectorAll('.stat-number');

            statCards.forEach(card => {
                const target = parseInt(card.getAttribute('data-target'));
                animateCounter(card, target);
            });

            // Unobserve after animation
            observer.unobserve(entry.target);
        }
    });
}, observerOptions);

// Subtle parallax effect for hero section
document.addEventListener('DOMContentLoaded', function() {
    // Start observing stats for counter animation
    const statsContainer = document.querySelector('.stats-row');
    if (statsContainer) {
        observer.observe(statsContainer);
    }

    // Initialize parallax effect
    const heroContent = document.querySelector('.hero-content');
    const heroSection = document.querySelector('.hero-section');

    if (heroContent && heroSection) {
        window.addEventListener('scroll', function() {
            const scrollY = window.scrollY;
            const heroHeight = heroSection.offsetHeight;

            // Only apply parallax while hero is visible
            if (scrollY < heroHeight) {
                const offset = scrollY * 0.3; // Subtle movement
                heroContent.style.transform = `translateY(${offset}px)`;
            }
        });
    }
});
</script>
{% endblock %}
